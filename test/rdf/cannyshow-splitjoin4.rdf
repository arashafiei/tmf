rdf cannyshow-splitjoin4 {
    topology {
        nodes = A,S,B,C,J,D;
	edges = e1(A,S), e2(S,B), e3(B,C), e4(C,J), e5(J,D);
    }
    actor A {
    	computation = VideoCaptureMR;
	file_name = pedestrian.mp4;
    }
    actor S {
	computation = MatSplit;
	level = 1;
    }
    actor B {
    	computation = CvtColor;
    }
    actor C {
    	computation = Canny;
    }
    actor J {
	computation = MatJoin;
	level = 1;
    }
    actor D {
    	computation = ImageShowMR;
    }
    parameter {
	logging = true;
    }
}
rule r1 {
left {
    topology {
        nodes = A,S,x,y,J,D;
	edges = e1(A,S), e2(S,x), e3(x,y), e4(y,J), e5(J,D);
    }
    actor A {
    	computation = VideoCaptureMR;
	file_name = pedestrian.mp4;
    }
    actor S {
    	computation = MatSplit;
	level = 1;
    }
    actor x {
    	computation = CvtColor;
    }
    actor y {
    	computation = Canny;
    }
    actor J {
    	computation = MatJoin;
	level = 1;
    }
    actor D {
    	computation = ImageShowMR;
    }
}
right {
    topology {
        nodes = A,S,x,x1,x2,x3,y,y1,y2,y3,J,D;
	edges = e1(A,S), e2(S,x), e3(S,x1), e4(S,x2), e5(S,x3),
		e6(x,y), e7(x1,y1), e8(x2,y2), e9(x3,y3), 
		e10(y,J), e11(y1,J), e12(y2,J), e13(y3,J), e14(J,D);
    }
    production {
	e14 = 4;
    }
    consumption {
	e1 = 4;
    }
    actor A {
    	computation = VideoCaptureMR;
	file_name = pedestrian.mp4;
    }
    actor S {
    	computation = MatSplit;
	level = 4;
    }
    actor x {
    	computation = CvtColor;
    }
    actor x1 {
    	computation = CvtColor;
    }
    actor x2 {
    	computation = CvtColor;
    }
    actor x3 {
    	computation = CvtColor;
    }
    actor y {
    	computation = Canny;
    }
    actor y1 {
    	computation = Canny;
    }
    actor y2 {
    	computation = Canny;
    }
    actor y3 {
    	computation = Canny;
    }
    actor J {
    	computation = MatJoin;
	level = 4;
    }
    actor D {
    	computation = ImageShowMR;
    }
}
}
main {
    load=32 : r1;
}
